# ูุณุชูุฏุงุช ุณุงุฎุชุงุฑ ุฏุงุฏูโูุง (Data Structure Documentation)

ุงู ุณูุฏ ุณุงุฎุชุงุฑ ูพุงฺฏุงู ุฏุงุฏูุ ูุฑูุช ูุงูโูุง ูพุดุชุจุงู ู ุงุณุชุฑุงุชฺ ูุฏุฑุช ุชุบุฑุงุช (Migration) ุฏุฑ ุงูพูฺฉุดู Flow ุฑุง ุชูุถุญ ูโุฏูุฏ.

## 1. ุณุงุฎุชุงุฑ ูพุงฺฏุงู ุฏุงุฏู (Database Schema)

ุงูพูฺฉุดู ุงุฒ SQLite ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโฺฉูุฏ. ุฌุฏุงูู ุงุตู ุนุจุงุฑุชูุฏ ุงุฒ:

### ุฌุฏูู `tasks` (ูุธุงู)
ุงุทูุงุนุงุช ูุฑุจูุท ุจู ูุธุงู ู ฺฉุงุฑูุง ุจุฑูุงููโุฑุฒ ุดุฏู. ูุถุนุช ูุฑ ุชุณฺฉ ุฏุฑ ูุฑ ุชุงุฑุฎ (ฺู ฺฉโุจุงุฑู ู ฺู ุชฺฉุฑุงุฑุดููุฏู) ููุญุตุฑุงู ุฏุฑ ููุฏ `statusHistory` ุจู ุตูุฑุช ฺฉ ูฺฏุงุดุช (Map) ุฐุฎุฑู ูโุดูุฏ.

| ุณุชูู | ููุน ุฏุงุฏู | ุชูุถุญุงุช |
| --- | --- | --- |
| `id` | INTEGER | ุดูุงุณู ฺฉุชุง (Primary Key, Auto Increment) |
| `title` | TEXT | ุนููุงู ูุธูู |
| `description` | TEXT | ุชูุถุญุงุช ุชฺฉูู |
| `dueDate` | TEXT | ุชุงุฑุฎ ุณุฑุฑุณุฏ ุงุตู (ISO 8601 String) |
| `priority` | INTEGER | ุงูููุช (0: Low, 1: Medium, 2: High) |
| `categories` | TEXT | ูุณุช ุดูุงุณูโูุง ุฏุณุชูโุจูุฏ (JSON String) |
| `tags` | TEXT | ูุณุช ุจุฑฺุณุจโูุง (JSON String) |
| `taskEmoji` | TEXT | ุงููุฌ ุงุฎุชุตุงุต ูุธูู |
| `attachments` | TEXT | ูุณุฑ ูุงูโูุง ูพูุณุช ุดุฏู (JSON String) |
| `recurrence` | TEXT | ุชูุธูุงุช ุชฺฉุฑุงุฑ ูุธูู (JSON String) |
| `statusHistory` | TEXT | ุชุงุฑุฎฺู ูุถุนุชโูุง ุจุฑุง ุฑูุฒูุง ูุฎุชูู (JSON Map: `{"YYYY-MM-DD": statusIndex}`) |
| `createdAt` | TEXT | ุชุงุฑุฎ ุงุฌุงุฏ |
| `updatedAt` | TEXT | ุชุงุฑุฎ ุขุฎุฑู ูุฑุงุด |
| `deletedAt` | TEXT | ุชุงุฑุฎ ุญุฐู (ุจุฑุง Soft Delete) |
| `isDeleted` | INTEGER | ูุถุนุช ุญุฐู (0: ูุนุงูุ 1: ุญุฐู ุดุฏู) |
| `position` | INTEGER | ูููุนุช ุจุฑุง ูุฑุชุจโุณุงุฒ |
| `metadata` | TEXT | ุฏุงุฏูโูุง ูุชูุฑูู (JSON String) |

#### ููููู ุฏุงุฏู `tasks`:
```json
{
  "id": 1001,
  "title": "ูุทุงูุนู ฺฉุชุงุจ ุชูุณุนู ูุฑุฏ",
  "description": "ุญุฏุงูู ฒฐ ุตูุญู ูุทุงูุนู ุฑูุฒุงูู",
  "dueDate": "2025-12-19T06:00:00.000Z",
  "priority": 2,
  "categories": ["study"],
  "tags": ["ุชูุณุนู ูุฑุฏ", "ุนุงุฏุช ุฎูุจ"],
  "taskEmoji": "๐",
  "recurrence": {
    "type": 1,
    "interval": 1,
    "endDate": "2026-01-20T23:59:59.000Z"
  },
  "statusHistory": {
    "2025-12-19": 1,
    "2025-12-20": 0,
    "2025-12-21": 2
  },
  "createdAt": "2025-12-18T18:00:00.000Z",
  "updatedAt": "2025-12-18T18:00:00.000Z",
  "isDeleted": 0,
  "position": 1,
  "metadata": {
    "hasTime": true,
    "reminderTime": "08:00"
  }
}
```

### ุฌุฏูู `categories` (ุฏุณุชูโุจูุฏโูุง)
ุงุทูุงุนุงุช ุฏุณุชูโุจูุฏโูุง ูุธุงู.

| ุณุชูู | ููุน ุฏุงุฏู | ุชูุถุญุงุช |
| --- | --- | --- |
| `id` | TEXT | ุดูุงุณู ูุชู ฺฉุชุง (Primary Key) |
| `label` | TEXT | ูุงู ููุงุด ุฏุงุฏู ุดุฏู |
| `emoji` | TEXT | ูุณุฑ ุงููุดู Lottie ุง ุงููุฌ |
| `color` | INTEGER | ฺฉุฏ ุฑูฺฏ (ARGB Integer) |
| `position` | INTEGER | ูููุนุช ุจุฑุง ูุฑุชุจโุณุงุฒ |

#### ููููู ุฏุงุฏู `categories`:
```json
{
  "id": "work",
  "label": "ฺฉุงุฑ",
  "emoji": "assets/images/DuckEmoji/86_WORK_OUT.json",
  "color": 4283215696,
  "position": 0
}
```

### ุฌุฏูู `task_events` (ุฑูุฏุงุฏูุง ุชุณฺฉ)
ูุงฺฏ ุชูุงู ุงุชูุงูุงุช ฺฉู ุจุฑุง ฺฉ ุชุณฺฉ ูโุงูุชุฏ ุจู ููุฑุงู ูพุงู ูุงุฑุณ ูุงุถุญ.

| ุณุชูู | ููุน ุฏุงุฏู | ุชูุถุญุงุช |
| --- | --- | --- |
| `id` | INTEGER | ุดูุงุณู ฺฉุชุง |
| `taskId` | INTEGER | ุดูุงุณู ุชุณฺฉ ูุฑุจูุทู |
| `type` | TEXT | ููุน ุฑูุฏุงุฏ (create, update, status, duplicate, postpone) |
| `occurredAt` | TEXT | ุฒูุงู ุฏูู ุฑุฎุฏุงุฏ |
| `payload` | TEXT | ุฌุฒุฆุงุช ุฑูุฏุงุฏ ู ูพุงู ูุงฺฏ ูุงุฑุณ (JSON String) |

#### ููููู ุฏุงุฏู `task_events`:
```json
{
  "id": 501,
  "taskId": 1001,
  "type": "status",
  "occurredAt": "2025-12-19T21:00:00.000Z",
  "payload": {
    "date": "2025-12-19",
    "status": 1,
    "log": "ุชุณฺฉ ุฏุฑ ุชุงุฑุฎ 2025-12-19 ุจู ูุถุนุช ุงูุฌุงู ุดุฏู ุชุบุฑ ุงูุช"
  }
}
```

### ุฌุฏูู `goals` (ุงูุฏุงู)
ุฐุฎุฑูโุณุงุฒ ุงูุฏุงู ุจููุฏูุฏุช ฺฉู ูุธุงู ูโุชูุงููุฏ ุจู ุขูโูุง ูุชุตู ุดููุฏ.

| ุณุชูู | ููุน ุฏุงุฏู | ุชูุถุญุงุช |
| --- | --- | --- |
| `id` | INTEGER | ุดูุงุณู ฺฉุชุง (Primary Key) |
| `title` | TEXT | ุนููุงู ูุฏู |
| `description` | TEXT | ุชูุถุญุงุช ูุฏู |
| `categoryIds` | TEXT | ูุณุช ุดูุงุณูโูุง ุฏุณุชูโุจูุฏ (JSON String) |
| `isCompleted` | INTEGER | ูุถุนุช ุงุชูุงู (0 ุง 1) |
| `completedAt` | TEXT | ุฒูุงู ุงุชูุงู |
| `isDeleted` | INTEGER | ูุถุนุช ุญุฐู ูุฑู (0 ุง 1) |
| `deletedAt` | TEXT | ุฒูุงู ุญุฐู |
| `createdAt` | TEXT | ุฒูุงู ุงุฌุงุฏ |
| `updatedAt` | TEXT | ุฒูุงู ุขุฎุฑู ูุฑุงุด |
| `attachments` | TEXT | ูุณุช ุดูุงุณู ุฑุณุงููโูุง (JSON String) |
| `audioPath` | TEXT | ูุณุฑ ูุงู ุตูุช ุงุตู |

### ุฌุฏูู `media` (ุฑุณุงููโูุง)
ูุฏุฑุช ูุงูโูุง ูุฒฺฉ (ุชุตุงูุฑุ ุตูุช ู ุบุฑู) ูุฑุชุจุท ุจุง ุชุณฺฉโูุง ู ุงูุฏุงู.

| ุณุชูู | ููุน ุฏุงุฏู | ุชูุถุญุงุช |
| --- | --- | --- |
| `id` | INTEGER | ุดูุงุณู ฺฉุชุง (Primary Key) |
| `filePath` | TEXT | ูุณุฑ ูุฒฺฉ ูุงู |
| `fileName` | TEXT | ูุงู ุงุตู ูุงู |
| `fileSize` | INTEGER | ุญุฌู ูุงู ุจู ุจุงุช |
| `mimeType` | TEXT | ููุน ูุงู (image/png, audio/mpeg ู ุบุฑู) |
| `taskId` | INTEGER | ุดูุงุณู ุชุณฺฉ ูุฑุชุจุท (ุงุฎุชุงุฑ) |
| `goalId` | INTEGER | ุดูุงุณู ูุฏู ูุฑุชุจุท (ุงุฎุชุงุฑ) |
| `createdAt` | TEXT | ุฒูุงู ุงุถุงูู ุดุฏู ุจู ุณุณุชู |

### ุฌุฏูู `settings` (ุชูุธูุงุช)
ุฐุฎุฑูโุณุงุฒ ุชูุธูุงุช ฺฉูุฏ ุจุฑูุงูู.

| ุณุชูู | ููุน ุฏุงุฏู | ุชูุถุญุงุช |
| --- | --- | --- |
| `key` | TEXT | ฺฉูุฏ ุชูุธูุงุช (Primary Key) |
| `value` | TEXT | ููุฏุงุฑ ุชูุธูุงุช |

#### ููููู ุฏุงุฏู `settings`:
```json
{
  "key": "last_import_theme",
  "value": "personal_development"
}
```

### 1.6 ุฏุณุชูโุจูุฏโูุง ูพุดโูุฑุถ (Default Categories)
ุงู ุฏุณุชูโุจูุฏโูุง ุฏููุงู ูุทุงุจู ุจุง ฺฉุฏูุง ุจุฑูุงูู (`category_data.dart`) ูุณุชูุฏ:

| ุดูุงุณู (ID) | ุจุฑฺุณุจ (Label) | ุฑูฺฏ (Hex) | ุงููุฌ/ุงููุดู (Emoji Asset) |
| --- | --- | --- | --- |
| `work` | ฺฉุงุฑ | #4CAF50 | `86_WORK_OUT.json` |
| `personal` | ุดุฎุต | #2196F3 | `101_HOME_OUT.json` |
| `sport` | ูุฑุฒุด | #FF9800 | `99_SPORT_OUT.json` |
| `study` | ูุทุงูุนู | #9C27B0 | `96_EDU_OUT.json` |
| `shopping` | ุฎุฑุฏ | #E91E63 | `100_SHOP_OUT.json` |
| `health` | ุณูุงูุช | #00BCD4 | `81_VIRUS_OUT.json` |
| `finance` | ูุงู | #FFFFC107 | `71_MONEY_OUT.json` |
| `travel` | ุณูุฑ | #3F51B5 | `103_PLANE_OUT.json` |

---

## 2. ุงุณุชุฑุงุชฺ ูุณุฎูโุจูุฏ ู ุชุบุฑุงุช (Versioning & Migration)

ุงูพูฺฉุดู ุงุฒ ุณุณุชู ูุณุฎูโุจูุฏ ุฏุงุฎู SQLite ุงุณุชูุงุฏู ูโฺฉูุฏ.
- **ูุณุฎู ฑฒ:** ุญุฐู ุฌุฏูู `task_completions` ู ุงูุชูุงู ูุถุนุชโูุง ุชฺฉุฑุงุฑ ุดููุฏู ุจู `statusHistory`.
- **ูุณุฎู ฑณ:** ุญุฐู ูุงุจุณุชฺฏ ุจู ุณุชูู `status` ู ุงูุชูุงู ุชูุงู ูุถุนุชโูุง ุจุงูโูุงูุฏู ุจู `statusHistory`. ุงฺฉููู ูุถุนุช ุชูุงู ุชุณฺฉโูุง ููุญุตุฑุงู ุงุฒ ุชุงุฑุฎฺู ุงุณุชุฎุฑุงุฌ ูโุดูุฏ.
- **ูุณุฎู ฑน:** ุงุถุงูู ุดุฏู ุณุชูู `categoryIds` ุจู ุฌุฏูู ุงูุฏุงู (Goals) ุจุฑุง ูพุดุชุจุงู ุงุฒ ฺูุฏ ุฏุณุชูโุจูุฏ.
- **ูุณุฎู ฒฐ:** ุจูโุฑูุฒุฑุณุงู ุฒุฑุณุงุฎุช ุจุฑุง ููฺฏุงูโุณุงุฒ ฺฉุงูู ุงูุฏุงู ู ุฑุณุงููโูุง ุฏุฑ ุณุณุชู ูพุดุชุจุงูโฺฏุฑ.

---

## 3. ูุฑูุช ูุงู ูพุดุชุจุงู (Export/Import Format)

ูุงูโูุง ูพุดุชุจุงู (JSON) ุดุงูู ุชูุงู ุฌุฏุงูู ุจุง ุณุงุฎุชุงุฑ ุชูุฒ ูุณุชูุฏ. ูุถุนุชโูุง ุงฺฉููู ุจุฎุด ุงุฒ ุฎูุฏู ุขุจุฌฺฉุช ุชุณฺฉ ูุณุชูุฏ. ุงุฒ ูุณุฎู ณุ ุงูุฏุงู ู ูฺฏุงุดุชโูุง ุฑุณุงููโุง ูุฒ ุงุถุงูู ุดุฏูโุงูุฏ.

### ุณุงุฎุชุงุฑ JSON (ูุณุฎู ณ):
```json
{
  "version": 3,
  "timestamp": "2025-12-31T10:00:00.000Z",
  "tasks": [...],
  "goals": [...],
  "categories": [...],
  "events": [...],
  "settings": [...]
}
```
ุฏุฑ ุฒูุงู ุฏุฑููโุฑุฒุ ุณุณุชู ุจู ุทูุฑ ููุดููุฏ ุดูุงุณูโูุง ูุฏู ุฑุง ุจู ุดูุงุณูโูุง ุฌุฏุฏ ูฺฏุงุดุช ูโฺฉูุฏ (Mapping) ุชุง ฺฉูพุงุฑฺฺฏ ุฏุงุฏูโูุง (ุชุณฺฉ ุจู ูุฏูุ ุชุณฺฉ ุจู ุฑุณุงูู) ุญูุธ ุดูุฏ.
